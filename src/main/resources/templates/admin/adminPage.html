<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>관리자 페이지</title>
 <link rel="stylesheet" href="/css/admin_page.css">
<style>
    .hidden { display: none; }
    input[type=checkbox].checkbox+label{
        height: 24px;
    }
</style>
</head>
<body>
    <th:block th:include="common/header"></th:block>
    <div class="adminpage">
        <div class="memberpage">
            <h1>회원 관리 페이지</h1>
            <table>
                <thead>
                    <tr>
                        <th>선택</th>
                        <th>번호</th>
                        <th>아이디</th>
                        <th>이름</th>
                        <th>전화번호</th>
                        <th>주소</th>
                        <th>가입일</th>
                        <th>회원등급</th>
                        <th>등급변경</th>
                        <th>신고횟수</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="m : ${list}">
                        <td>
                            <div class="input-wrap">
                                <input type="checkbox" class="checkbox">
                                <label></label>
                            </div>
                        </td>
                        <td th:text="${m.memberNo}"></td>
                        <td th:text="${m.memberId}"></td>
                        <td th:text="${m.memberName}"></td>
                        <td th:text="${m.memberPhone}"></td>
                        <td th:text="${m.memberAddr}"></td>
                        <td th:text="${m.memberRegDate}"></td>
                        <td>
                            <div class="select" th:switch="${m.memberGrade}">
                            	<select th:case="1">
                                	<option value="1" selected>관리자</option>
                                	<option value="2">정회원</option>
                                	<option value="3">블랙</option>
                            	</select>
                            	<select th:case="2">
                                	<option value="1">관리자</option>
                                	<option value="2" selected>정회원</option>
                                	<option value="3">블랙</option>
                            	</select>
                            	<select th:case="3">
                                	<option value="1">관리자</option>
                                	<option value="2">정회원</option>
                                	<option value="3" selected>블랙</option>
                            	</select>
                            	</div>
                        </td>
                        <td>
                            <button class="changeGrade">등급변경</button>
                        </td>
                        <td th:text="${m.memberReport}"></td>
                    </tr>
                </tbody>
            </table>
            <div class="buttons">
                <button onclick="location.href='report_page.html'">신고 처리 페이지</button>
                <button onclick="changeSelectedMemberGrade()">선택 회원 등급 변경</button>
                <button onclick="filterBlackGrade()">블랙 등급만 보기</button>
                <div class="pagination">
                    <a href="#" class="disabled">&laquo; 이전</a>
                    <a href="#" class="active">1</a>
                    <a href="#" class="disabled">2</a>
                    <a href="#" class="disabled">3</a>
                    <a href="#" class="disabled">4</a>
                    <a href="#" class="disabled">5</a>
                    <a href="#" class="disabled">다음 &raquo;</a>
                </div>
            </div>
        </div>
    </div>
    <script>
    $(".changeGrade").on("click",function(){
		
		const memberGrade = $(this).parent().parent().children().eq(1).text();
		
		const memberGrade = $(this).parent().prev().children().children().val();
		
		location.href="/admin/changeGrade?memberGrade="+memberNo+"&memberGrade="+memberGrade;
	});
	
	$(".checkedChangeGrade").on("click",function(){
		const check = $(".checkbox:checked");
		if(check.length == 0){//선택된 회원이없으면 함수 종료
			return;
		}
		//체크된 회원 번호를 모두 저장할 배열
		const no = new Array();
		//체크된 회원 등급을 모두 저장할 배열
		const grade = new Array();
		
		//체크된 체크박스 기준으로 회원번호와 등급을 가져와서 각각 배열에 push
		check.each(function(index,item){
			const memberNo = $(item).parent().parent().next().text();
			no.push(memberNo);	
			const memberGrade = $(item).parent().parent().parent().find("select").val();
			grade.push(memberGrade);
			
		});
		console.log(no);
		console.log(Grade);
		location.href="/admin/checkedChangeGrade?no="+no.join("/")+"&Grade="+Grade.join("/");
			
	});
    </script>
    <th:block th:include="common/footer"></th:block>
</body>
</html>
